<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#8338ec">
  <link rel="manifest" href="manifest.json">
  <title>LUMIX ARTIFICIAL ‚Ä¢ Card√°pio</title>
  <style>
    :root {
      --grad-1: #8338ec; --grad-2: #ff006e; --grad-3: #adff02; --bg: #0c0a09;
      --card: #1c1917; --text: #f2f2f2; --neon-fucsia: #ff006e; --neon-verde: #adff02;
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 0; line-height: 1.5; }
    .hero { height: 60vh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 0 20px; animation: fadeIn 1s ease-out; background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('background.png'); background-size: cover; background-position: center center; background-repeat: no-repeat; }
    .hero img.logo { width: 150px; height: 150px; border-radius: 50%; border: 4px solid var(--neon-verde); box-shadow: 0 0 20px var(--neon-verde), inset 0 0 10px var(--neon-verde); animation: pulse 2s infinite ease-in-out; }
    .hero h1 { font-size: 2.5em; font-weight: 800; margin: 20px 0 10px; text-shadow: 0 0 10px var(--bg); }
    .hero p { font-size: 1.1em; max-width: 500px; opacity: 0.9; text-shadow: 0 0 5px var(--bg); }
    .catalog-wrapper { padding: 0 20px 20px 20px; }
    .toolbar { display: flex; gap: 10px; margin: 20px 0; align-items: center; }
    #searchBar { flex-grow: 1; background-color: var(--card); border: 1px solid #333; color: var(--text); border-radius: 20px; padding: 12px 20px; font-size: 1em; }
    #notificationsBtn { background-color: var(--card); border: 1px solid #333; color: var(--text); border-radius: 50%; width: 45px; height: 45px; font-size: 1.5em; cursor: pointer; flex-shrink: 0; display: flex; align-items: center; justify-content: center; transition: color 0.2s; }
    #notificationsBtn.active { color: var(--neon-fucsia); }
    .category-filters { display: flex; justify-content: center; gap: 10px; margin-bottom: 25px; flex-wrap: wrap; }
    .category-filters button { background: var(--card); color: var(--text); border: 1px solid #333; padding: 10px 20px; border-radius: 20px; cursor: pointer; transition: all 0.2s; }
    .category-filters button.active { background: var(--neon-fucsia); color: white; border-color: var(--neon-fucsia); font-weight: bold; }
    .catalog-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
    .category-title { color: var(--neon-verde); font-size: 1.8em; font-weight: bold; margin-top: 40px; margin-bottom: 20px; border-bottom: 2px solid var(--neon-fucsia); padding-bottom: 10px; }
    .product-row { display: flex; overflow-x: auto; gap: 15px; padding: 10px; margin: 0 -10px; scrollbar-width: thin; scrollbar-color: var(--neon-fucsia) var(--card); }
    .product-row::-webkit-scrollbar { height: 8px; }
    .product-row::-webkit-scrollbar-thumb { background-color: var(--neon-fucsia); border-radius: 4px; }
    .product-row::-webkit-scrollbar-track { background-color: var(--card); }
    .card { background-color: var(--card); border-radius: 12px; overflow: hidden; display: flex; flex-direction: column; border: 1px solid #333; cursor: pointer; transition: transform 0.2s; width: 280px; flex-shrink: 0; }
    .card:hover { transform: translateY(-5px); }
    .card-img { height: 160px; width: 100%; object-fit: cover; }
    .card-body { padding: 15px; flex-grow: 1; }
    .card-title { font-size: 1.2em; font-weight: 600; margin: 0 0 5px; }
    .card-desc { font-size: 0.9em; opacity: 0.7; margin: 0 0 15px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; }
    .card-footer { padding: 0 15px 15px; display: flex; justify-content: space-between; align-items: center; }
    .price { font-size: 1.3em; font-weight: 700; color: var(--neon-verde); }
    button { background: var(--neon-fucsia); color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; text-shadow: 0 0 5px rgba(0,0,0,0.5); }
    button:hover { transform: scale(1.05); box-shadow: 0 0 20px var(--neon-fucsia); }
    .cart-float { position: fixed; bottom: 20px; right: 20px; background: linear-gradient(135deg, var(--grad-1), var(--grad-2)); color: white; border-radius: 50%; width: 60px; height: 60px; display: flex; justify-content: center; align-items: center; font-size: 1.5em; font-weight: 700; cursor: pointer; box-shadow: 0 5px 20px rgba(0,0,0,0.4); z-index: 1000; }
    .modal { display: none; position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); backdrop-filter: blur(5px); overflow-y: auto; }
    .modal-content { background: var(--bg); margin: 5% auto; padding: 25px; border: 1px solid var(--neon-fucsia); border-radius: 12px; max-width: 90%; width: 500px; box-shadow: 0 0 30px var(--neon-fucsia); animation: fadeIn 0.3s; }
    .cart-row { display: flex; flex-direction: column; padding: 10px 0; border-bottom: 1px solid #333; }
    .cart-row-main { display: flex; justify-content: space-between; align-items: center; }
    .cart-row-options { font-size: 0.8em; opacity: 0.7; margin-top: 5px; padding-left: 10px; border-left: 2px solid var(--neon-fucsia); }
    .ghost { background: transparent; border: 1px solid var(--neon-fucsia); color: var(--neon-fucsia); }
    .product-detail-modal-img { width: 100%; height: 250px; object-fit: cover; border-radius: 10px; margin-bottom: 20px; }
    .product-detail-modal-title { font-size: 2em; margin: 0; }
    .product-detail-modal-price { font-size: 1.5em; color: var(--neon-verde); margin: 10px 0; }
    .product-detail-modal-desc { opacity: 0.8; margin-bottom: 25px; }
    .options-form h3 { color: var(--neon-verde); margin-top: 25px; margin-bottom: 10px; font-size: 1.1em; }
    .options-form .radio-group label { display: flex; align-items: center; background-color: var(--card); padding: 15px; border-radius: 8px; margin-bottom: 10px; cursor: pointer; border: 2px solid #333; transition: border-color 0.2s; }
    .options-form .radio-group input:checked + label { border-color: var(--neon-fucsia); }
    .options-form .radio-group input { display: none; }
    .options-form textarea { width: 100%; background-color: var(--card); border: 1px solid #333; color: var(--text); border-radius: 8px; padding: 10px; min-height: 80px; box-sizing: border-box; }
  </style>
</head>
<body>
  <div class="hero">
    <img src="logo.png" alt="Logo de LUMIX ARTIFICIAL" class="logo">
    <h1>LUMIX ARTIFICIAL</h1>
    <p>Seu pedido na velocidade da luz. Explore nosso card√°pio interativo e pe√ßa agora.</p>
  </div>
  <div class="catalog-wrapper">
    <div class="toolbar">
      <input type="search" id="searchBar" placeholder="üîé Buscar no card√°pio...">
      <button id="notificationsBtn" title="Ativar notifica√ß√µes">üîî</button>
    </div>
    <div class="category-filters" id="categoryFilters"></div>
    <div id="catalog"></div>
  </div>
  <div class="cart-float" id="openCart" style="display: none;"><span id="cartCount">0</span></div>
  <div class="modal" id="cartModal">
    <div class="modal-content">
      <h2>Seu Pedido</h2>
      <div id="cartItems"></div>
      <hr>
      <h3>Total: <span id="cartTotal">R$ 0,00</span></h3>
      <button id="orderWhats">Pedir pelo WhatsApp</button>
      <button class="ghost" id="closeCart">Continuar Comprando</button>
    </div>
  </div>
  <div class="modal" id="productDetailModal">
    <div class="modal-content" id="productDetailContent"></div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
        const catalog = document.getElementById('catalog');
        const categoryFilters = document.getElementById('categoryFilters');
        const productDetailModal = document.getElementById('productDetailModal');
        const productDetailContent = document.getElementById('productDetailContent');
        const cartFloat = document.getElementById('openCart');
        const cartCount = document.getElementById('cartCount');
        const cartModal = document.getElementById('cartModal');
        const cartItems = document.getElementById('cartItems');
        const cartTotal = document.getElementById('cartTotal');
        const openCart = document.getElementById('openCart');
        const closeCart = document.getElementById('closeCart');
        const orderWhats = document.getElementById('orderWhats');
        const searchBar = document.getElementById('searchBar');
        const notificationsBtn = document.getElementById('notificationsBtn');
        let cart = [];

        const money = val => val.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

        const products = [
            // --- PRATOS (8) ---
            {id: 1, name: 'Picanha na Chapa', price: 89.90, desc: 'Picanha fatiada com mandioca cozida na manteiga de garrafa e vinagrete.', category: 'Pratos', img: 'https://images.pexels.com/photos/853005/pexels-photo-853005.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1', options: { protein: ['Carne Bovina', 'Carne de Sol'], cutlery: true }},
            {id: 4, name: 'Strogonoff', price: 45.50, desc: 'Cremoso strogonoff com cogumelos, acompanha arroz branco e batata palha.', category: 'Pratos', img: 'https://images.pexels.com/photos/13523293/pexels-photo-13523293.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1', options: { protein: ['Frango', 'Fil√© Mignon'], cutlery: true }},
            {id: 2, name: 'Feijoada Completa', price: 59.90, desc: 'Acompanha arroz, couve, farofa, torresmo e laranja. Servida √†s quartas e s√°bados.', category: 'Pratos', img: 'https://images.pexels.com/photos/9940428/pexels-photo-9940428.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 3, name: 'Moqueca de Peixe', price: 79.90, desc: 'Deliciosa moqueca com peixe branco, piment√µes, tomate, leite de coco e azeite de dend√™. Acompanha arroz e pir√£o.', category: 'Pratos', img: 'https://images.pexels.com/photos/8993888/pexels-photo-8993888.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1', options: { cutlery: true }},
            {id: 5, name: 'Parmegiana de Mignon', price: 65.00, desc: 'Bife de fil√© mignon √† parmegiana com muito queijo, acompanha arroz e fritas.', category: 'Pratos', img: 'https://images.pexels.com/photos/10398075/pexels-photo-10398075.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1', options: { cutlery: true }},
            {id: 24, name: 'Bai√£o de Dois', price: 52.00, desc: 'Prato nordestino com arroz, feij√£o fradinho, carne seca, queijo coalho e cheiro-verde.', category: 'Pratos', img: 'https://images.pexels.com/photos/12737656/pexels-photo-12737656.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 25, name: 'Lasanha √† Bolonhesa', price: 48.00, desc: 'Generosa por√ß√£o de lasanha com massa fresca, molho bolonhesa e queijo mussarela gratinado.', category: 'Pratos', img: 'https://images.pexels.com/photos/2790240/pexels-photo-2790240.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1', options: { cutlery: true }},
            {id: 26, name: 'Salm√£o Grelhado', price: 75.00, desc: 'Posta de salm√£o grelhado ao molho de maracuj√°, acompanha arroz com br√≥colis e legumes.', category: 'Pratos', img: 'https://images.pexels.com/photos/3763847/pexels-photo-3763847.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1', options: { cutlery: true }},

            // --- POR√á√ïES (8) ---
            {id: 6, name: 'Fritas com Cheddar e Bacon', price: 35.90, desc: 'Por√ß√£o generosa de batatas fritas crocantes com cheddar cremoso e bacon em cubos.', category: 'Por√ß√µes', img: 'https://images.pexels.com/photos/115740/pexels-photo-115740.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 7, name: 'An√©is de Cebola', price: 29.90, desc: 'An√©is de cebola empanados e crocantes, acompanha molho barbecue da casa.', category: 'Por√ß√µes', img: 'https://images.pexels.com/photos/4106411/pexels-photo-4106411.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 27, name: 'Dadinho de Tapioca', price: 32.00, desc: 'Cubinhos de tapioca com queijo coalho, acompanha geleia de pimenta.', category: 'Por√ß√µes', img: 'https://images.pexels.com/photos/15928822/pexels-photo-15928822/free-photo-of-comida-pao-jantar-delicioso.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 28, name: 'Torresmo de Rolo', price: 45.00, desc: 'Pancetta de porco pururucada, crocante por fora e macia por dentro. Acompanha lim√£o.', category: 'Por√ß√µes', img: 'https://images.pexels.com/photos/12833077/pexels-photo-12833077.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 29, name: 'Bolinho de Bacalhau', price: 38.00, desc: 'Por√ß√£o com 10 unidades do cl√°ssico bolinho de bacalhau portugu√™s.', category: 'Por√ß√µes', img: 'https://images.pexels.com/photos/6419742/pexels-photo-6419742.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 30, name: 'T√°bua de Frios', price: 68.00, desc: 'Sele√ß√£o de queijos, salames, presunto de parma, azeitonas e p√£es.', category: 'Por√ß√µes', img: 'https://images.pexels.com/photos/2116094/pexels-photo-2116094.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 9, name: 'Iscas de Til√°pia', price: 42.00, desc: 'Tirinhas de til√°pia empanadas e fritas, perfeitas para petiscar. Acompanha molho t√°rtaro.', category: 'Por√ß√µes', img: 'https://images.pexels.com/photos/262959/pexels-photo-262959.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 10, name: 'Past√©is Mistos', price: 32.00, desc: 'Por√ß√£o com 8 past√©is: Carne Seca com Catupiry e Queijo.', category: 'Por√ß√µes', img: 'https://images.pexels.com/photos/8145265/pexels-photo-8145265.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},

            // --- SOBREMESAS (7) ---
            {id: 11, name: 'Pudim de Leite', price: 15.00, desc: 'Cl√°ssico pudim de leite condensado com calda de caramelo, cremoso e irresist√≠vel.', category: 'Sobremesas', img: 'https://images.pexels.com/photos/4694293/pexels-photo-4694293.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 12, name: 'Mousse de Maracuj√°', price: 18.00, desc: 'Mousse aerado com o azedinho e doce na medida certa, com calda de maracuj√° fresco.', category: 'Sobremesas', img: 'https://images.pexels.com/photos/5741151/pexels-photo-5741151.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 13, name: 'A√ßa√≠ na Tigela (500ml)', price: 25.00, desc: 'A√ßa√≠ batido com banana, acompanha granola, leite em p√≥ e leite condensado.', category: 'Sobremesas', img: 'https://images.pexels.com/photos/5946639/pexels-photo-5946639.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 14, name: 'Petit Gateau', price: 22.90, desc: 'Bolinho quente de chocolate com interior cremoso, servido com sorvete de creme e calda.', category: 'Sobremesas', img: 'https://images.pexels.com/photos/6938018/pexels-photo-6938018.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 15, name: 'Torta Holandesa', price: 19.90, desc: 'Fatia de torta com base de biscoito, creme holand√™s e cobertura de chocolate.', category: 'Sobremesas', img: 'https://images.pexels.com/photos/101533/pexels-photo-101533.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 31, name: 'Cheesecake de Frutas Vermelhas', price: 24.00, desc: 'Fatia da famosa torta de queijo com uma generosa calda de frutas vermelhas.', category: 'Sobremesas', img: 'https://images.pexels.com/photos/1126359/pexels-photo-1126359.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 32, name: 'Salada de Frutas', price: 16.00, desc: 'Mix de frutas da esta√ß√£o: mam√£o, mel√£o, morango, uva e manga.', category: 'Sobremesas', img: 'https://images.pexels.com/photos/1092730/pexels-photo-1092730.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},

            // --- BEBIDAS (7) ---
            {id: 16, name: 'Caipirinha de Lim√£o', price: 18.00, desc: 'A tradicional caipirinha brasileira, feita com cacha√ßa de qualidade, lim√£o e a√ß√∫car.', category: 'Bebidas', img: 'https://images.pexels.com/photos/4397732/pexels-photo-4397732.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 17, name: 'Guaran√° Antarctica (Lata)', price: 7.00, desc: 'O refrigerante com o sabor original do Brasil.', category: 'Bebidas', img: 'https://images.pexels.com/photos/1301373/pexels-photo-1301373.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 18, name: '√Ågua de Coco (500ml)', price: 9.00, desc: '√Ågua de coco natural e gelada, direto da fruta.', category: 'Bebidas', img: 'https://images.pexels.com/photos/1429424/pexels-photo-1429424.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 19, name: 'Suco de Laranja Natural (500ml)', price: 10.00, desc: 'Feito com laranjas frescas espremidas na hora.', category: 'Bebidas', img: 'https://images.pexels.com/photos/161586/juice-fruit-superfood-drink-161586.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 20, name: 'Cerveja Long Neck', price: 12.00, desc: 'Escolha entre Heineken, Budweiser ou Stella Artois.', category: 'Bebidas', img: 'https://images.pexels.com/photos/1267697/pexels-photo-1267697.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 33, name: 'Coca-Cola (Lata)', price: 7.00, desc: 'Coca-Cola original, gelada e refrescante.', category: 'Bebidas', img: 'https://images.pexels.com/photos/2967921/pexels-photo-2967921.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'},
            {id: 34, name: 'Caf√© Espresso', price: 6.00, desc: 'Caf√© forte e encorpado para finalizar sua refei√ß√£o.', category: 'Bebidas', img: 'https://images.pexels.com/photos/312418/pexels-photo-312418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'}
        ];
        
        function renderCategories() {
            const categories = ['Todos', ...new Set(products.map(p => p.category).filter(c => c))];
            categoryFilters.innerHTML = '';
            categories.forEach(category => {
                const btn = document.createElement('button');
                btn.dataset.category = category.toLowerCase();
                btn.textContent = category;
                categoryFilters.appendChild(btn);
            });
        }

        function renderCatalog(searchTerm = '', categoryFilter = 'todos') {
            catalog.innerHTML = '';
            const searchLower = searchTerm.toLowerCase();
            const filteredProducts = products.filter(p => {
                const matchesCategory = categoryFilter === 'todos' || (p.category && p.category.toLowerCase() === categoryFilter);
                const matchesSearch = p.name.toLowerCase().includes(searchLower) || p.desc.toLowerCase().includes(searchLower);
                return matchesCategory && matchesSearch;
            });

            if (categoryFilter === 'todos' && searchTerm === '') {
                const categories = [...new Set(products.map(p => p.category).filter(c => c))];
                categories.forEach(category => {
                    catalog.innerHTML += `<h2 class="category-title">${category}</h2>`;
                    const productRow = document.createElement('div');
                    productRow.className = 'product-row';
                    products.filter(p => p.category === category).forEach(p => { productRow.appendChild(createProductCard(p)); });
                    catalog.appendChild(productRow);
                });
            } else {
                const catalogGrid = document.createElement('div');
                catalogGrid.className = 'catalog-grid';
                filteredProducts.forEach(p => { catalogGrid.appendChild(createProductCard(p)); });
                catalog.appendChild(catalogGrid);
            }
            addCardEventListeners();
        }

        function createProductCard(p) {
            const el = document.createElement('div');
            el.className = 'card';
            el.dataset.details = p.id;
            el.innerHTML = `
                <img src="${p.img}" alt="${p.name}" class="card-img">
                <div class="card-body"><h3 class="card-title">${p.name}</h3><p class="card-desc">${p.desc}</p></div>
                <div class="card-footer"><span class="price">${money(p.price)}</span>
                <button class="ghost">${p.options ? 'Ver Op√ß√µes' : 'Adicionar'}</button></div>`;
            return el;
        }

        function showProductDetail(id) {
            const p = products.find(x => x.id == id);
            let optionsHtml = '';
            if (p.options) {
                optionsHtml += '<form id="productOptionsForm" class="options-form">';
                if (p.options.protein) {
                    optionsHtml += '<h3>Escolha a Prote√≠na</h3><div class="radio-group">';
                    p.options.protein.forEach((item, index) => {
                        optionsHtml += `<input type="radio" id="protein_${index}" name="protein" value="${item}" ${index === 0 ? 'checked' : ''}><label for="protein_${index}">${item}</label>`;
                    });
                    optionsHtml += '</div>';
                }
                if (p.options.cutlery) {
                    optionsHtml += '<h3>Precisa de talheres?</h3><div class="radio-group">';
                    optionsHtml += `<input type="radio" id="cutlery_yes" name="cutlery" value="Sim" checked><label for="cutlery_yes">Sim</label><input type="radio" id="cutlery_no" name="cutlery" value="N√£o"><label for="cutlery_no">N√£o</label>`;
                    optionsHtml += '</div>';
                }
                optionsHtml += '<h3>Observa√ß√µes</h3><textarea id="observations" placeholder="Ex: tirar a cebola, ponto da carne, etc."></textarea>';
                optionsHtml += '</form>';
            }
            productDetailContent.innerHTML = `
                <img src="${p.img}" alt="${p.name}" class="product-detail-modal-img"><h2 class="product-detail-modal-title">${p.name}</h2>
                <p class="product-detail-modal-price">${money(p.price)}</p><p class="product-detail-modal-desc">${p.desc}</p>
                ${optionsHtml} <br><button id="addToCartFromDetail">Adicionar ao Carrinho</button><button class="ghost" id="closeDetailModal">Voltar</button>`;
            productDetailModal.style.display = 'block';
            document.getElementById('addToCartFromDetail').addEventListener('click', () => {
                const selectedOptions = {};
                const form = document.getElementById('productOptionsForm');
                if (form) {
                    const protein = form.querySelector('input[name="protein"]:checked'); if (protein) selectedOptions.protein = protein.value;
                    const cutlery = form.querySelector('input[name="cutlery"]:checked'); if (cutlery) selectedOptions.cutlery = cutlery.value;
                    const obs = form.querySelector('#observations'); if (obs && obs.value.trim() !== '') selectedOptions.observa√ß√µes = obs.value.trim();
                }
                addToCart(id, selectedOptions);
                productDetailModal.style.display = 'none';
            });
            document.getElementById('closeDetailModal').addEventListener('click', () => { productDetailModal.style.display = 'none'; });
        }

        function addCardEventListeners() {
            document.querySelectorAll('[data-details]').forEach(card => {
                card.addEventListener('click', e => {
                    const id = +e.currentTarget.dataset.details;
                    const product = products.find(p => p.id === id);
                    if (e.target.tagName === 'BUTTON' && !product.options) {
                        e.stopPropagation();
                        addToCart(id);
                    } else {
                        showProductDetail(id);
                    }
                });
            });
        }

        function addToCart(productId, options = {}) {
            const product = products.find(p => p.id === productId);
            const optionsKey = JSON.stringify(options);
            const existingItem = cart.find(item => item.productId === productId && JSON.stringify(item.options) === optionsKey);
            if (existingItem) { existingItem.quantity++; } 
            else { cart.push({ cartItemId: Date.now().toString(), productId, quantity: 1, options, name: product.name, price: product.price });}
            updateCartUI();
        }

        function removeFromCart(cartItemId) {
            const itemIndex = cart.findIndex(item => item.cartItemId === cartItemId);
            if (itemIndex > -1) {
                cart[itemIndex].quantity--;
                if (cart[itemIndex].quantity <= 0) cart.splice(itemIndex, 1);
            }
            updateCartUI();
        }

        function updateCartUI() {
            const totalCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const totalValue = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            cartFloat.style.display = totalCount > 0 ? 'flex' : 'none';
            cartCount.textContent = totalCount;
            cartTotal.textContent = money(totalValue);
            cartItems.innerHTML = '';
            cart.forEach(item => {
                let optionsText = Object.entries(item.options).map(([key, value]) => `<strong>${key.charAt(0).toUpperCase() + key.slice(1)}:</strong> ${value}`).join('<br>');
                const row = document.createElement('div');
                row.className = 'cart-row';
                row.innerHTML = `<div class="cart-row-main"><span>${item.name} x ${item.quantity}</span><span>${money(item.price * item.quantity)} <button class='ghost' data-rem='${item.cartItemId}'>-</button></span></div>${optionsText ? `<div class="cart-row-options">${optionsText}</div>` : ''}`;
                cartItems.appendChild(row);
            });
            document.querySelectorAll('[data-rem]').forEach(b => b.addEventListener('click', e => { removeFromCart(e.currentTarget.dataset.rem); }));
            localStorage.setItem('lumixCart', JSON.stringify(cart));
        }

        function loadCart() {
            const savedCart = localStorage.getItem('lumixCart');
            if (savedCart) { try { cart = JSON.parse(savedCart) || []; } catch (e) { cart = []; } }
        }

        function setupEventListeners() {
            categoryFilters.addEventListener('click', e => {
                if (e.target.tagName === 'BUTTON') {
                    const selectedCategory = e.target.dataset.category;
                    categoryFilters.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
                    e.target.classList.add('active');
                    renderCatalog(searchBar.value, selectedCategory);
                }
            });
            searchBar.addEventListener('input', () => {
                const activeBtn = categoryFilters.querySelector('button.active');
                renderCatalog(searchBar.value, activeBtn ? activeBtn.dataset.category : 'todos');
            });
            openCart.addEventListener('click', () => { cartModal.style.display = 'block'; });
            closeCart.addEventListener('click', () => { cartModal.style.display = 'none'; });
            productDetailModal.addEventListener('click', e => { if (e.target === productDetailModal) productDetailModal.style.display = 'none'; });
            orderWhats.addEventListener('click', () => {
                const phone = '+5562999998888'; 
                let lines = ['*Ol√° LUMIX ARTIFICIAL! ü§ñ Gostaria de fazer um pedido:*\n'];
                cart.forEach(item => {
                    lines.push(`- ${item.quantity}x ${item.name}`);
                    let optionsText = Object.entries(item.options).map(([key, value]) => `  - ${key.charAt(0).toUpperCase() + key.slice(1)}: ${value}`).join('\n');
                    if (optionsText) lines.push(optionsText);
                });
                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                lines.push('\n*Total estimado: ' + money(total) + '*');
                const text = encodeURIComponent(lines.join('\n'));
                window.open('https://wa.me/' + phone.replace(/\+/g, '') + '?text=' + text, '_blank');
            });
            notificationsBtn.addEventListener('click', () => {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        notificationsBtn.classList.add('active');
                        new Notification('LUMIX ARTIFICIAL', { body: 'Pronto! Agora voc√™ receber√° nossas novidades e promo√ß√µes.', icon: 'logo.png' });
                    }
                });
            });
        }
        
        function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js').catch(err => console.error('Falha ao registrar Service Worker:', err));
            }
        }
        
        function init() {
            loadCart();
            renderCategories();
            renderCatalog();
            updateCartUI();
            setupEventListeners();
            registerServiceWorker();
            const firstCategoryButton = categoryFilters.querySelector('button');
            if(firstCategoryButton) firstCategoryButton.classList.add('active');
        }

        init();
    });
  </script>
</body>
</html>



